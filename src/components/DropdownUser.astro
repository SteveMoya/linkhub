---
import { SignOut } from 'auth-astro/components'
import { getSession } from 'auth-astro/server'

const session = await getSession(Astro.request)
const name = session?.user?.name
const userimage = session?.user?.image
---
<div class="flex items-center md:order-2 space-x-3 md:space-x-0 rtl:space-x-reverse relative">
  <button type="button" class="flex items-center gap-1 text-sm rounded-full md:me-0" id="user-menu-button" user-menu-button aria-expanded="false" data-dropdown-toggle="user-dropdown" data-dropdown-placement="bottom">
    <img class="w-7 h-7 rounded-full border-[.5px] border-neutral-600/25 " src={userimage} alt="user photo" />
    <svg width=".7rem" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" xml:space="preserve"><path style="fill-rule:evenodd;clip-rule:evenodd" d="M3 6h18l-9 13z"/></svg>
  </button>
  <div class="absolute right-[-1rem] top-[1.5rem] z-50 my-4 hidden list-none divide-y dark:divide-neutral-200 overflow-hidden rounded-lg border-[1px] dark:border-neutral-600 dark:bg-neutral-900 text-base shadow divide-neutral-300 border-neutral-300 bg-neutral-100" id="user-dropdown">
    <div class="px-4 py-3">
      <span>{name}</span>
    </div>
    <ul aria-labelledby="user-menu-button">
      <li class="hover:bg-neutral-200 dark:hover:bg-neutral-800">
        <SignOut class="flex justify-between text-start text-sm min-w-36 py-2 px-4" title="Logout">
          Cerran Sesi√≥n
          <svg style="scale: -1;" width="1.35em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 12h8M16 15l-2.913-2.913v0a.123.123 0 0 1 0-.174v0L16 9"/><path d="M16 5v-.5 0A1.5 1.5 0 0 0 14.5 3H5a2 2 0
            0 0-2 2v14a2 2 0 0 0 2 2h9.5a1.5 1.5 0 0 0 1.5-1.5v0-.5"/></g></svg>
        </SignOut>
      </li>
    </ul>
  </div>
</div>